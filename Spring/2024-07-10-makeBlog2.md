# 블로그 만들기 미니 프로젝트 part2
## 블로그 글 목록 조회를 위한 API 구현하기
### 1. 서비스 메소드 코드 추가 작성
데이터 베이스에 저장되어있는 그을 모두 가져오는 findAll 메소드 작성
JPA 지원 메서드인 findAll()을 호출에 article 테이블에 저장되어있는 모든 데이터를 조회

```java
package com.mysite.myblog.service;

import com.mysite.myblog.domain.Article;
import com.mysite.myblog.dto.AddArticleRequest;
import com.mysite.myblog.repository.BlogRepository;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;

import java.util.List;

@RequiredArgsConstructor
@Service
public class BlogService {
    private final BlogRepository blogRepository;

    public Article save(AddArticleRequest request) {
        return blogRepository.save(request.toEntity());
    }

    public List<Article> findAll() {
        return blogRepository.findAll();
    }
}
```
<br>

### 2. 컨트롤러 메서드 코드 추가 작성
요청을 받아 서비스에 전달
/api/articles GET요청이 오면 글 목록을 조회할 findAllArticles() 메서드 작성
<br><br>
그전에 응답을 위한 DTO클래스 먼저 작성
제목과 내용에 해당하는 필드를 가진 클래스를 만든다음, 엔티티를 인수로 받는 생성자 추가
<br>

DTO클래스 ArticleResponse.class

```java
package com.mysite.myblog.dto;

import com.mysite.myblog.domain.Article;
import lombok.Getter;

@Getter
public class ArticleResponse {
    private final String title;
    private final String content;

    public ArticleResponse(Article article){
        this.title = article.getTitle();
        this.content = article.getContent();
    }
}
```

/api/articles GET 요청이 오면 글 전체를 조회하는 findAll() 메서드를 호출한 다음 응답용 객체인 AricleResponse로 파싱해 body에 담아 클라이언트에게 전송하는 코드 추가

```java
package com.mysite.myblog.controller;

import com.mysite.myblog.domain.Article;
import com.mysite.myblog.dto.AddArticleRequest;
import com.mysite.myblog.dto.ArticleResponse;
import com.mysite.myblog.service.BlogService;
import lombok.RequiredArgsConstructor;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RestController;

import java.util.List;

@RequiredArgsConstructor
@RestController
public class BlogApiController {
    private final BlogService blogService;

    @PostMapping("/api/articles")
    public ResponseEntity<Article> addArticle(@RequestBody AddArticleRequest request) {
        Article savedArticle = blogService.save(request);

        return ResponseEntity.status(HttpStatus.CREATED)
                .body(savedArticle);
    }

    //추가된 부분
    @GetMapping("/api/articles")
    public ResponseEntity<List<ArticleResponse>> findAllArticles() {
        List<ArticleResponse> articles = blogService.findAll()
                .stream()
                .map(ArticleResponse::new)
                .toList();

        return  ResponseEntity.ok()
                .body(articles);
    }
}
```

* @GetMapping("/api/articles"): HTTP GET요청을 처리하는 메서드 지정
* public ResponseEntity<List<ArticleResponse>> findAllArticles() 
    * ResponseEntity를 반환, HTTP응답의 상태코드와 body를 모두 포함할 수 있음
    * 반환타입은 List<AritcleResponse>로 ArticleResponse 객체의 리스트를 반환
* List<ArticleResponse> articles = blogService.findAll().stream().map(ArticleResponse::new).toList();
    * blogService.findAll(): 메서드를 호출하여 모든 글의 리스트를 가져옴, 서비스 계청에서 글 데이터 가져옴
    * .stream().map(ArticleResponse::new): 가지온 글 리스트를 stream으로 변호나 후 각 기사를 ArticleREsponse 객체로 매핑
    * ArticleResponse::new는 각 기사를 ArticleResponse생성자로 전달하여 새로운 객체를 생성한다.
    * .toList()메서드를 호출하여 스트림을 리스트로 반환
* return ResponseEntity.ok().body(articles);
    * ResponseEntity.ok() 메서드를 호출하여 HTTP 상태 코드 200을 설정(200 OK는 요청이 성공적으로 수행되었음을 뜻함)
    }
}
